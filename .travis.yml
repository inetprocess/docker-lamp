sudo: required
dist: trusty

language: python
python:
  - "3.4"
  - "3.5"
  - "3.6"

install:
  - pip install .
  - stakkr-init
  - pip install -r requirements-dev.txt

env:
  global:
  - TRAVIS_SECURE_ENV_VARS=true
  - secure: "hW1SDD/B8CwafVkhPi0zmwIwasBWTxjUlfUhRTOSvoVYNiMIRqMPuMWG+zwkJ9Maw6xlfY9nltlQs8cuE56Wk3pxxR3ddh1rW1pSkqGqUBprDCzGqk6ziID7UUr4TGzTaanUfZEoNjZaNhCXl73LVApNhFhuRzTJ2SD+zNdEddRjAIxmpOWELwLFkxKhqvK4qW+u8DGFrOFTWgFoUOMf6Lf9483Fk0rTwor7IOrwiIaeHPLfJivayqpkHcR/0GDTJsheDCnDs6wIHnwyQdCZh+TXkemjv0QH/JBdUqEiEQ5bbUK/dOJsRZQlm8GBDqQnpP18is6cpO3eFxOBPawU0Kfb7UQph75kmelbn7jm6JVJSREg6557+v9l5iC0QkTxWn1VSbgz+syS+NMweYauZUaoCnGfZ6jQcXCTkN78J1c+UKPtXCeCjThTikxA0eaubbCL5Ea0E5QOXePtlQKHR4ITk0DI5hj4E+f442hP9ZJZAexWG+HqyspJF86GRbR2LS+ubn2KAo1rZ83ugvy3/cO0luXao7Baa6mKKOQU0Tr1yzGar4VhVZhWQq9LPJ+Si/9xWPr3CScr2myatVVIC+Sl6gpQCz0+jIc2EdB/uzS3JsNdYTwybrKvKWYLczlOjE0ObcclgoxPdGbIXAgkUaRNE+8oqjiiKkpd/FcOd0g="

notifications:
  slack:
    secure: "AHk143RYRkH37sY/Q23eI71/83ailGNVduQ8tI+YNLYAz/9WWofE/LkxDHrQNOziVqblh55lStB0znPlj+wAlHbFvZBH9sYHccms8oVvWpmxzXZakDqEvbg+8lDzYsKnreBBGvY+YGk8n4sqwvN63Ob+FoG/NAE2hhpz+GMYFBadA20zQqnCqso1WkF47pPYiks7Zx6oYsw67yNr3VEplUFiPgzYBCO8IhX5kdqobFYqiuDKtJkQh6B0lZRMdwzY5LYk/zXwPAWTjMHeAmNluDjE8UonBFam6YGZ3p009dT0TKYGx2lclugV7NcFyTz3xeSlBjxhUZTlhclq6IpOenoagYI8gwYQcKrmzJuDTABS8E/Y7p8yHhezKX7qn6+NQ+jr7RygW0XD/o0pKTfrfnsmzATymcE2idiva7sl4sxjMTZp+3mrQJeqHgJ1e6LQ+ZW3zdDSwHnwRl5IxBxF5J36BMuTf8w9dAF6suj0b4DjgRc+4P/jNvTy1tAu/1kpKjStRbEJwmuzESdkvWo9yEO0UMlTa3vC4eIp/hO6+Rkp2ZmFeH9xDuCNejYoHJi1i3Dh2P49PrxK21+o0jjyEctxjBNBnuAbvr87NHAi+0MdTKd3i+58HDZdrHT2G39tWVoaN+diLRheC1Hca+oB1QgdrCIK2gG/Yyh8w4JWd28="

before_script:
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build

# command to run tests
script: py.test

after_script:
  - coverage xml
  - if [[ "$TRAVIS_PYTHON_VERSION" == "3.6" ]]; then ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT; fi
